# Laravel Lesson レビュー①

## Todo一覧機能

### Todoモデルのallメソッドで実行しているSQLは何か
SELECT * FROM todos;
（todosテーブルから全件取得するSQL）

### Todoモデルのallメソッドの返り値は何か
Illuminate\Database\Eloquent\Collection クラスのインスタンスで、Todoモデルのコレクション。

Collectionクラスのインスタンス。
CollectionクラスにはTodoインスタンスが格納されている。
Todosテーブルのカラム、レコードを配列で取得
データ存在時の返り値はarrayで返される。

### 配列の代わりにCollectionクラスを使用するメリットは
Collectionインスタンスが配列操作に特化したクラスで、
Laravelを利用する場合にはより効率的に操作できるため。

Laravelの便利なメソッドが多数使える。
チェーンメソッド（filter, map, sortなど）が使える。
読みやすく、保守性が高いコードになる。

### view関数の第1・第2引数の指定と何をしているか
第1引数：ビューのパス（例: 'todos.index'）
第2引数：ビューに渡すデータ（例: ['todos' => $todos]）
→ 指定したビューを表示し、データをビューに渡す

第１引数には表示する画面のview名を指定、第２引数で連想配列でviewにデータを渡している。
第２引数の連想配列は、bladeでの変数名->代入したい値という内容になっている。

### index.blade.phpの$todos・$todoに代入されているものは何か
$todos: コントローラから渡されたTodoモデルのコレクション
$todo: foreachなどで1件ずつ取り出したTodoモデルのインスタンス

view関数で第２引数で指定されたデータがview内で使用できる変数に代入されている。
＄todosが全てのtodoデータ、$todoはループ中に$todosから取り出された１つのtodoデータとなる。

## Todo作成機能


### Requestクラスのallメソッドは何をしているか
フォームから送信された全入力データを配列で取得する。
HTTPリクエストから送信された全てのデータを連想配列として取得している。

### fillメソッドは何をしているか
配列で渡された値を、モデルの属性に一括で代入する
（ただし$fillableで許可されたカラムのみ）

Todoインスタンスの各プロパティに一括で代入する
Modelのfill()メソッドを使用することで引数に指定した連想配列を一括代入できる。

### $fillableは何のために設定しているか
fillやcreateなどで一括代入を許可するカラムを制限し、
マスアサインメント（不正な代入）を防ぐため。

第三者からの意図しないカラムの追加を防いでいる。

### saveメソッドで実行しているSQLは何か
新規作成時：INSERT
INSERT INTO todos (title, ...) VALUES (...);
更新時：UPDATE
UPDATE todos SET title = ... WHERE id = ...;

### redirect()->route()は何をしているか
第１引数にrouteを定義した名前を記述する。
指定したルート名にリダイレクト（HTTPのLocationヘッダを返す）する。

ルートが変更された場合にも名前で一括管理できるため保守性が高い。

## その他

### テーブル構成をマイグレーションファイルで管理するメリット
DB構成をコードで管理できる（バージョン管理も可能）
→SQLを知らなくてもPHPコードでテーブルを操作できる。
チーム開発で統一されたDB環境を再現できる
→マイグレーションファイルをGitで共有することで開発者全員が同じテーブルを作成できる
 現在のデータベースの状態を他の開発者に共有することができる。
デプロイ時に簡単にテーブルを作成できる
デプロイ→開発していたWebアプリをサーバーやクラウドにアップロードして
使えるように公開・配置すること。

### マイグレーションファイルのup()、down()は何のコマンドを実行した時に呼び出されるのか
up() → php artisan migrate で呼ばれる
これは、データベースに新しいテーブル、カラム、インデックスを追加するために使用する。

down() → php artisan migrate:rollback で呼ばれる
これは、up()で実行された変更を取り消すために使用する。

### Seederクラスの役割は何か
開発・テスト用の初期データをDBに挿入する処理を記述する
開発者間で差異が発生しないようするための役割がある。

### route関数の引数・返り値・使用するメリット
web.php内
Route::get(/todo','TodoController@index')で
第１引数：ルート名（文字列）、
第２引数：Controllerとそのメソッドを指定することによってそのルートのURLを作れる。
また、->name('todo.index')を追記することで
上記のルートに対応するURLに名前を定義することができる

パラメータ（配列）
返り値：対応するURL文字列
メリット：URL変更時にコード全体を修正せずに済む（ルート名で管理）ため、
保守性と可読性が高い。


### @extends・@section・@yieldの関係性とbladeを分割するメリット
親テンプレート（継承元）となるbase.blade.php部分に@yield（’文字列’）を記述して内容を埋め込み、
子テンプレート（継承先）に@extends('\resources\views以降のパス')を使うことで継承する。

子テンプレート内で@section（’文字列’）を使うことで親の@yield（’文字列’）に対応した内容を
埋め込むことができる。

bladeを分割することで、複数のbledeを組み合わせて使うことができ、
重複するコードを共通化することで再利用性・保守性・見通しを向上できる。

@extends：レイアウトファイルを継承
@section：継承元の特定部分にコンテンツを挿入
@yield：継承元で挿入位置を定義

### @csrfは何のための記述か
クロスサイトリクエストフォージェリ（CSRF）対策用のトークンをフォームに埋め込む
→ LaravelがPOSTリクエストの正当性を検証し、悪意あるリクエストを防ぐことができる。

自動的にCSRFトークンを作成
CSRFトークンを一意のキーとしてHTMLフォームを埋め込み、サーバー側でトークンの検証を行う。

### {{ }}とは何の省略系か
<?php echo e(); ?> の省略系
→ 変数をHTMLエスケープして安全に表示する
特殊文字を文字列として登録し、XSS（クロスサイトスクリプティング）攻撃を防ぐ。
&→&amp;
<→&lt;
>→&gt;
"→&quot;
'→&#039;,&apos;

<!-- バックスラッシュはOption+￥で打てる -->






